
  !!! When sending bug reports tell us what version of wxWindows you are 
      using (including the beta) and what compiler on what system. One 
      example: wxWINE 2.1 snapshot 6, egcs 1.1.1, Redhat 5.0 !!!

* Preparing WINE
----------------

Most C++ compilers cannot compile the WINE sources yet (this includes
all versions of g++ and ecgs) so you have to make a minimal change
and recompile all of WINE in order to get anywhere.

This change has do be applied to the /include/windef.h file, line 59
in the section "Calling convention defintions", where the sources
reads:

#if __i386__

which has to be changed into

#if 0

After this change, you'll have to recompile all of WINE without
forgetting to install it. The direct consequence of this change
is that the Win32 binary emulator won't work anymore, as the
change disables the Windows native calling convention.

* The most simple case
-----------------------

If you compile wxWindows on Linux for the first time and don't like to read 
install instructions just do (in the base dir):

> ./configure --with-wine
> make
> su <type root password>
> make install
> ldconfig
> exit

On all variants of Unix except Linux (and maybe except *BSD), shared libraries 
are not supportet out of the box due to the utter stupidity of libtool, so you'll 
have to do this to get shared library support:

> ./configure --with-wine --disable-static --enable-shared

Then you'll have to edit the wrongly created libtool script. There are two
important entries with respect to shared library creation, which are

  archive_cmds="\$LD -shared ....
  archive_expsym_cmds="\$LD -shared ....
  
which should be something like

  archive_cmds="\$CC -shared ....
  archive_expsym_cmds="\$CC -shared ....
  
Afterwards you can continue with

> make
> su <type root password>
> make install
> ldconfig
> exit

If you want to remove wxWindows on Unix you can do this:

> su <type root password>
> make uninstall
> ldconfig
> exit

* The expert case
-----------------

If you want to do some more serious cross-platform programming with wxWindows, 
such as for GTK and Motif, you can now build two complete libraries and use 
them concurretly. For this end, you have to create a directory for each build 
of wxWindows - you may also want to create different versions of wxWindows
and test them concurrently. Most typically, this would be a version configured 
with --enable-debug_flag and one without. Note, that only one build can currently 
be installed, so you'd have to use local version of the library for that purpose.
For building three versions (one GTK, one WINE and a debug version of the WINE 
source) you'd do this:

md buildmotif
cd buildmotif
../configure --with-motif
make
cd ..

md buildwine
cd buildwine
../configure --with-wine
make
cd ..

md buildwined
cd buildwined
../configure --with-wine --enable-debug_flag
make
cd ..

* The most simple errors
------------------------

wxWINE doesn't work yet as WINE isn't really up to the task yet. 

You get errors during compilation: The reason is that you probably have a broken 
compiler, which includes almost everything that is called gcc. If you use gcc 2.8 
you have to disable optimsation as the compiler will give up with an internal 
compiler error.

If there is just any way for you to use egcs, use egcs. We cannot fix gcc.

You get immediate segfault when starting any sample or application: This is either 
due to having compiled the library with different flags or options than your program - 
typically you might have the __WXDEBUG__ option set for the library but not for your 
program - or due to using a broken compiler (and its optimisation) such as GCC 2.8.

* The most simple program
-------------------------

Now create your super-application myfoo.app and compile anywhere with

g++ myfoo.cpp `wx-config --libs --cflags` -o myfoo

* General
-----------------------

The Unix variants of wxWindows use GNU configure. If you have problems with your 
make use GNU make instead.

If you have general problems with installation, read my homepage at 

  http://wesley.informatik.uni-freiburg.de/~wxxt
  
for newest information. If you still don't have any success, please send a bug 
report to one of our mailing lists (see my homepage) INCLUDING A DESCRIPTION OF 
YOUR SYSTEM AND YOUR PROBLEM, SUCH AS YOUR VERSION OF WINE, WXWINE, WHAT DISTRIBUTION 
YOU USE AND WHAT ERROR WAS REPORTED. I know this has no effect, but I tried...

* GUI libraries
-----------------------

wxWindows/WINE requires the WINE library to be installed on your system. 

You can get the newest version of the WINE from the WINE homepage at:

  http://www.winehq.com
  
* Create your configuration
-----------------------------

Usage:
	./configure options

If you want to use system's C and C++ compiler,
set environment variables CC and CCC as

	% setenv CC cc
	% setenv CCC CC
	% ./configure options

to see all the options please use:

	./configure --help

The basic philosophy is that if you want to use different
configurations, like a debug and a release version, 
or use the same source tree on different systems,
you have only to change the environment variable OSTYPE.
(Sadly this variable is not set by default on some systems
in some shells - on SGI's for example). So you will have to 
set it there. This variable HAS to be set before starting 
configure, so that it knows which system it tries to 
configure for.

Configure will complain if the system variable OSTYPE has 
not been defined. And Make in some circumstances as well...


* General options
-------------------

Given below are the commands to change the default behaviour,
i.e. if it says "--disable-threads" it means that threads
are enabled by default.

Many of the confiugre options have been thoroughly tested
in wxWindows snapshot 6, but not yet all (ODBC not).

You must do this by running configure with either of:

        --with-wine              Use the WINE library
	
The following options handle the kind of library you want to build.

	--enable-threads        Compile without thread support. Threads
	                        support is also required for the
				socket code to work.

	--disable-shared        Do not create shared libraries.

	--disable-optimise	Do not optimise the code. Can
	                        sometimes be useful for debugging
				and is required on some architectures
				such as Sun with gcc 2.8.X which
				would otherwise produce segvs.

	--enable-profile        Add profiling info to the object 
				files. Currently broken, I think.
				
	--enable-no_rtti        Enable compilation without creation of
	                        C++ RTTI information in object files. 
				This will speed-up compilation and reduce 
				binary size.
				
	--enable-no_exceptions  Enable compilation without creation of
	                        C++ exception information in object files. 
				This will speed-up compilation and reduce 
				binary size. Also fewer crashes during the
				actual compilation...
				
	--enable-mem_tracing    Add built-in memory tracing. 
				
	--enable-dmalloc        Use the dmalloc memory debugger.
	                        Read more at www.letters.com/dmalloc/
				
	--enable-debug_info	Add debug info to object files and
	                        executables for use with debuggers
				such as gdb (or its many frontends).

	--enable-debug_flag	Define __DEBUG__ and __WXDEBUG__ when
	                        compiling. This enable wxWindows' very
				useful internal debugging tricks (such
				as automatically reporting illegal calls)
				to work. Note that program and library
				must be compiled with the same debug 
				options.

* Feature Options
-------------------

Many of the confiugre options have been thoroughly tested
in wxWindows snapshot 6, but not yet all (ODBC not).

When producing an executable that is linked statically with wxGTK
you'll be surprised at its immense size. This can sometimes be
drastically reduced by removing features from wxWindows that 
are not used in your program. The most relevant such features
are

	--without-libpng	Disables PNG image format code.
	
	--without-libjpeg	Disables JPEG image format code.
	
{	--without-odbc          Disables ODBC code. Not yet. }
	
        --disable-resources     Disables the use of *.wxr type
	                        resources.
		
	--disable-threads       Disables threads. Will also
	                        disable sockets.

	--disable-sockets       Disables sockets.

	--disable-dnd           Disables Drag'n'Drop.
	
	--disable-clipboard     Disables Clipboard.
	
	--disable-serial        Disables object instance serialiasation.
	
	--disable-streams       Disables the wxStream classes.
	
	--disable-file          Disables the wxFile class.
	
	--disable-textfile      Disables the wxTextFile class.
	
	--disable-intl          Disables the internationalisation.
	
	--disable-validators    Disables validators.
	
	--disable-accel         Disables accel.
	
Apart from disabling certain features you can very often "strip"
the program of its debugging information resulting in a significant
reduction in size.

* Compiling
-------------

The following must be done in the base directory (e.g. ~/wxGTK
or ~/wxWin or whatever)

Now the makefiles are created (by configure) and you can compile 
the library by typing:

	make

make yourself some coffee, as it will take some time. On an old
386SX possibly two weeks. During compilation, you'll get a few 
warning messages depending in your compiler.

If you want to be more selective, you can change into a specific
directiry and type "make" there.

Then you may install the library and it's header files under
/usr/local/include/wx and /usr/local/lib respectively. You
have to log in as root (i.e. run "su" and enter the root
password) and type

        make install	

You can remove any traces of wxWindows by typing

        make uninstall
	
If you want to save disk space by removing unnecessary
object-files:

	 make clean

in the various directories will do the work for you.

* Creating a new Project
--------------------------

1) The first way uses the installed libraries and header files
automatically using wx-config

g++ myfoo.cpp `wx-config --libs` `wx-config --cflags` -o myfoo

Using this way, a make file for the minimal sample would look
like this

CC = g++

minimal: minimal.o
    $(CC) -o minimal minimal.o `wx-config --libs` 

minimal.o: minimal.cpp mondrian.xpm
    $(CC) `wx-config --cflags` -c minimal.cpp -o minimal.o

clean: 
	rm -f *.o minimal

This is certain to become the standard way unless we decide
to sitch to tmake.

2) The other way creates a project within the source code 
directories of wxWindows. For this endeavour, you'll need
the usual number of GNU tools, at least

GNU automake version 1.4
GNU autoheader version 2.14
GNU autoconf version 2.14
GNU libtool version 1.3

and quite possibly 

GNU make
GNU C++

and if you have all this then you probably know enough to
go ahead yourself :-)

----------------------

In the hope that it will be useful,

        Robert Roebling <roebling@sun2.ruf.uni-freiburg.de>
	
	
