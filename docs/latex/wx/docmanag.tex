%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Name:        docmanag.tex
%% Purpose:     wxDocManager documentation
%% Author:      wxWidgets Team
%% Modified by:
%% Created:     
%% RCS-ID:      $Id$
%% Copyright:   (c) wxWidgets Team
%% License:     wxWindows license
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{\class{wxDocManager}}\label{wxdocmanager}

The wxDocManager class is part of the document/view framework supported by wxWidgets,
and cooperates with the \helpref{wxView}{wxview}, \helpref{wxDocument}{wxdocument}\rtfsp
and \helpref{wxDocTemplate}{wxdoctemplate} classes.

\wxheading{Derived from}

\helpref{wxEvtHandler}{wxevthandler}\\
\helpref{wxObject}{wxobject}

\wxheading{Include files}

<wx/docview.h>

\wxheading{See also}

\helpref{wxDocManager overview}{wxdocmanageroverview}, \helpref{wxDocument}{wxdocument},\rtfsp
\helpref{wxView}{wxview}, \helpref{wxDocTemplate}{wxdoctemplate}, \helpref{wxFileHistory}{wxfilehistory}

\latexignore{\rtfignore{\wxheading{Members}}}


\membersection{wxDocManager::m\_currentView}\label{wxdocmanagermcreateview}

\member{wxView*}{m\_currentView}

The currently active view.


\membersection{wxDocManager::m\_defaultDocumentNameCounter}\label{wxdocmanagermdefaultdocumentnamecounter}

\member{int}{m\_defaultDocumentNameCounter}

Stores the integer to be used for the next default document name.


\membersection{wxDocManager::m\_fileHistory}\label{wxdocmanagermfilehistory}

\member{wxFileHistory*}{m\_fileHistory}

A pointer to an instance of \helpref{wxFileHistory}{wxfilehistory},
which manages the history of recently-visited files on the File menu.


\membersection{wxDocManager::m\_maxDocsOpen}\label{wxdocmanagermmaxdocsopen}

\member{int}{m\_maxDocsOpen}

Stores the maximum number of documents that can be opened before
existing documents are closed. By default, this is 10,000.


\membersection{wxDocManager::m\_docs}\label{wxdocmanagermdocs}

\member{wxList}{m\_docs}

A list of all documents.


\membersection{wxDocManager::m\_flags}\label{wxdocmanagermflags}

\member{long}{m\_flags}

Stores the flags passed to the constructor.


\membersection{wxDocManager::m\_lastDirectory}\label{wxdocmanagermlastdirectory}

The directory last selected by the user when opening a file.

\member{wxFileHistory*}{m\_fileHistory}


\membersection{wxDocManager::m\_templates}\label{wxdocmanagermtemplates}

\member{wxList}{m\_templates}

A list of all document templates.


\membersection{wxDocManager::wxDocManager}\label{wxdocmanagerctor}

\func{}{wxDocManager}{\param{long}{ flags = wxDEFAULT\_DOCMAN\_FLAGS}, \param{bool}{ initialize = true}}

Constructor. Create a document manager instance dynamically near the start of your application
before doing any document or view operations.

{\it flags} is currently unused.

If {\it initialize} is true, the \helpref{Initialize}{wxdocmanagerinitialize} function will be called
to create a default history list object. If you derive from wxDocManager, you may wish to call the
base constructor with false, and then call Initialize in your own constructor, to allow
your own Initialize or OnCreateFileHistory functions to be called.


\membersection{wxDocManager::\destruct{wxDocManager}}\label{wxdocmanagerdtor}

\func{void}{\destruct{wxDocManager}}{\void}

Destructor.


\membersection{wxDocManager::ActivateView}\label{wxdocmanageractivateview}

\func{void}{ActivateView}{\param{wxView* }{doc}, \param{bool}{ activate = true}}

Sets the current view.


\membersection{wxDocManager::AddDocument}\label{wxdocmanageradddocument}

\func{void}{AddDocument}{\param{wxDocument *}{doc}}

Adds the document to the list of documents.


\membersection{wxDocManager::AddFileToHistory}\label{wxdocmanageraddfiletohistory}

\func{void}{AddFileToHistory}{\param{const wxString\& }{filename}}

Adds a file to the file history list, if we have a pointer to an appropriate file menu.


\membersection{wxDocManager::AssociateTemplate}\label{wxdocmanagerassociatetemplate}

\func{void}{AssociateTemplate}{\param{wxDocTemplate *}{temp}}

Adds the template to the document manager's template list.


\membersection{wxDocManager::CloseDocuments}\label{wxdocmanagerclosedocuments}

\func{bool}{CloseDocuments}{\param{bool }{force = true}}

Closes all currently opened documents.


\membersection{wxDocManager::CreateDocument}\label{wxdocmanagercreatedocument}

\func{wxDocument*}{CreateDocument}{\param{const wxString\& }{path}, \param{long}{ flags}}

Creates a new document in a manner determined by the {\it flags} parameter, which can be:

\begin{itemize}\itemsep=0pt
\item wxDOC\_NEW Creates a fresh document.
\item wxDOC\_SILENT Silently loads the given document file.
\end{itemize}

If wxDOC\_NEW is present, a new document will be created and returned, possibly after
asking the user for a template to use if there is more than one document template.
If wxDOC\_SILENT is present, a new document will be created and the given file loaded
into it. If neither of these flags is present, the user will be presented with
a file selector for the file to load, and the template to use will be determined by the
extension (Windows) or by popping up a template choice list (other platforms).

If the maximum number of documents has been reached, this function
will delete the oldest currently loaded document before creating a new one.


\membersection{wxDocManager::CreateView}\label{wxdocmanagercreateview}

\func{wxView*}{CreateView}{\param{wxDocument*}{doc}, \param{long}{ flags}}

Creates a new view for the given document. If more than one view is allowed for the
document (by virtue of multiple templates mentioning the same document type), a choice
of view is presented to the user.


\membersection{wxDocManager::DisassociateTemplate}\label{wxdocmanagerdisassociatetemplate}

\func{void}{DisassociateTemplate}{\param{wxDocTemplate *}{temp}}

Removes the template from the list of templates.


\membersection{wxDocManager::FileHistoryAddFilesToMenu}\label{wxdocmanagerfilehistoryaddfilestomenu}

\func{void}{FileHistoryAddFilesToMenu}{\void}

Appends the files in the history list, to all menus managed by the file history object.

\func{void}{FileHistoryAddFilesToMenu}{\param{wxMenu*}{ menu}}

Appends the files in the history list, to the given menu only.


\membersection{wxDocManager::FileHistoryLoad}\label{wxdocmanagerfilehistoryload}

\func{void}{FileHistoryLoad}{\param{wxConfigBase\& }{config}}

Loads the file history from a config object.

\wxheading{See also}

\helpref{wxConfig}{wxconfigbase}


\membersection{wxDocManager::FileHistoryRemoveMenu}\label{wxdocmanagerfilehistoryremovemenu}

\func{void}{FileHistoryRemoveMenu}{\param{wxMenu*}{ menu}}

Removes the given menu from the list of menus managed by the file history object.


\membersection{wxDocManager::FileHistorySave}\label{wxdocmanagerfilehistorysave}

\func{void}{FileHistorySave}{\param{wxConfigBase\& }{resourceFile}}

Saves the file history into a config object. This must be called
explicitly by the application.

\wxheading{See also}

\helpref{wxConfig}{wxconfigbase}


\membersection{wxDocManager::FileHistoryUseMenu}\label{wxdocmanagerfilehistoryusemenu}

\func{void}{FileHistoryUseMenu}{\param{wxMenu*}{ menu}}

Use this menu for appending recently-visited document filenames, for convenient
access. Calling this function with a valid menu pointer enables the history
list functionality.

Note that you can add multiple menus using this function, to be managed by the
file history object.


\membersection{wxDocManager::FindTemplateForPath}\label{wxdocmanagerfindtemplateforpath}

\func{wxDocTemplate *}{FindTemplateForPath}{\param{const wxString\& }{path}}

Given a path, try to find template that matches the extension. This is only
an approximate method of finding a template for creating a document.


\membersection{wxDocManager::GetCurrentDocument}\label{wxdocmanagergetcurrentdocument}

\func{wxDocument *}{GetCurrentDocument}{\void}

Returns the document associated with the currently active view (if any).


\membersection{wxDocManager::GetCurrentView}\label{wxdocmanagergetcurrentview}

\func{wxView *}{GetCurrentView}{\void}

Returns the currently active view 


\membersection{wxDocManager::GetDocuments}\label{wxdocmanagergetdocuments}

\func{wxList\&}{GetDocuments}{\void}

Returns a reference to the list of documents.


\membersection{wxDocManager::GetFileHistory}\label{wxdocmanagergetfilehistory}

\func{wxFileHistory *}{GetFileHistory}{\void}

Returns a pointer to file history.


\membersection{wxDocManager::GetLastDirectory}\label{wxdocmanagergetlastdirectory}

\constfunc{wxString}{GetLastDirectory}{\void}

Returns the directory last selected by the user when opening a file. Initially empty.


\membersection{wxDocManager::GetMaxDocsOpen}\label{wxdocmanagergetmaxdocsopen}

\func{int}{GetMaxDocsOpen}{\void}

Returns the number of documents that can be open simultaneously.


\membersection{wxDocManager::GetHistoryFilesCount}\label{wxdocmanagergethistoryfilescount}

\func{size\_t}{GetHistoryFilesCount}{\void}

Returns the number of files currently stored in the file history.


\membersection{wxDocManager::GetTemplates}\label{wxdocmanagergettemplates}

\func{wxList\&}{GetTemplates}{\void}

Returns a reference to the list of associated templates.


\membersection{wxDocManager::Initialize}\label{wxdocmanagerinitialize}

\func{bool}{Initialize}{\void}

Initializes data; currently just calls OnCreateFileHistory. Some data cannot
always be initialized in the constructor because the programmer must be given
the opportunity to override functionality. If OnCreateFileHistory was called
from the constructor, an overridden virtual OnCreateFileHistory would not be
called due to C++'s `interesting' constructor semantics. In fact Initialize
\rtfsp{\it is} called from the wxDocManager constructor, but this can be
vetoed by passing false to the second argument, allowing the derived class's
constructor to call Initialize, possibly calling a different OnCreateFileHistory
from the default.

The bottom line: if you're not deriving from Initialize, forget it and
construct wxDocManager with no arguments.


\membersection{wxDocManager::MakeDefaultName}\label{wxdocmanagermakedefaultname}

\func{bool}{MakeDefaultName}{\param{const wxString\& }{buf}}

This method is preserved for backwards compatibility in wxWidgets 2.8 but is
renamed to \helpref{MakeNewDocumentName}{wxdocmanagermakenewdocumentname} in
wxWidgets 3.0, please see its description for the details.

This function simply copies the value returned by MakeNewDocumentName() into
the provided \arg{buf} and returns \true.

\perlnote{In wxPerl this function must return the modified name rather
than just modifying the argument.}


\membersection{wxDocManager::MakeNewDocumentName}\label{wxdocmanagermakenewdocumentname}

\func{wxString}{MakeNewDocumentName}{\void}

Returns the name to be used for a new document. The default implementation
appends an integer counter to the string {\bf unnamed} and increments the
counter. To customize this behaviour, you need to override the virtual 
\helpref{MakeNewDocumentName}{wxdocmanagermakedefaultname} method but if you
only need to call this method, an not to override it, please use this method
which is forward-compatible with wxWidgets 3.0.

\newsince{2.8.8}


\membersection{wxDocManager::OnCreateFileHistory}\label{wxdocmanageroncreatefilehistory}

\func{wxFileHistory *}{OnCreateFileHistory}{\void}

A hook to allow a derived class to create a different type of file history. Called
from \helpref{Initialize}{wxdocmanagerinitialize}.


\membersection{wxDocManager::OnFileClose}\label{wxdocmanageronfileclose}

\func{void}{OnFileClose}{\param{wxCommandEvent\& }{event}}

Closes and deletes the currently active document.


\membersection{wxDocManager::OnFileCloseAll}\label{wxdocmanageronfilecloseall}

\func{void}{OnFileCloseAll}{\param{wxCommandEvent\& }{event}}

Closes and deletes all the currently opened documents.


\membersection{wxDocManager::OnFileNew}\label{wxdocmanageronfilenew}

\func{void}{OnFileNew}{\param{wxCommandEvent\& }{event}}

Creates a document from a list of templates (if more than one template).


\membersection{wxDocManager::OnFileOpen}\label{wxdocmanageronfileopen}

\func{void}{OnFileOpen}{\param{wxCommandEvent\& }{event}}

Creates a new document and reads in the selected file.


\membersection{wxDocManager::OnFileRevert}\label{wxdocmanageronfilerevert}

\func{void}{OnFileRevert}{\param{wxCommandEvent\& }{event}}

Reverts the current document by calling wxDocument::Revert for the current document.


\membersection{wxDocManager::OnFileSave}\label{wxdocmanageronfilesave}

\func{void}{OnFileSave}{\param{wxCommandEvent\& }{event}}

Saves the current document by calling wxDocument::Save for the current document.


\membersection{wxDocManager::OnFileSaveAs}\label{wxdocmanageronfilesaveas}

\func{void}{OnFileSaveAs}{\param{wxCommandEvent\& }{event}}

Calls wxDocument::SaveAs for the current document.


\membersection{wxDocManager::RemoveDocument}\label{wxdocmanagerremovedocument}

\func{void}{RemoveDocument}{\param{wxDocument *}{doc}}

Removes the document from the list of documents.


\membersection{wxDocManager::SelectDocumentPath}\label{wxdocmanagerselectdocumentpath}

\func{wxDocTemplate *}{SelectDocumentPath}{\param{wxDocTemplate **}{templates},
 \param{int}{ noTemplates}, \param{wxString\& }{path}, 
 \param{long}{ flags}, \param{bool}{ save}}

Under Windows, pops up a file selector with a list of filters corresponding to document templates.
The wxDocTemplate corresponding to the selected file's extension is returned.

On other platforms, if there is more than one document template a choice list is popped up,
followed by a file selector.

This function is used in wxDocManager::CreateDocument.

\perlnote{In wxPerl {\tt templates} is a reference to a list of templates.
If you override this method in your document manager it must return
two values, eg:\par
  (doctemplate, path) = My::DocManager->SelectDocumentPath( ... );
}


\membersection{wxDocManager::SelectDocumentType}\label{wxdocmanagerselectdocumenttype}

\func{wxDocTemplate *}{SelectDocumentType}{\param{wxDocTemplate **}{templates},
 \param{int}{ noTemplates}, \param{bool}{ sort=false}}

Returns a document template by asking the user (if there is more than one template).
This function is used in wxDocManager::CreateDocument.

\wxheading{Parameters}

\docparam{templates}{Pointer to an array of templates from which to choose a desired template.}
\docparam{noTemplates}{Number of templates being pointed to by the {\it templates} pointer.}
\docparam{sort}{If more than one template is passed in in {\it templates}, 
then this parameter indicates whether the list of templates that the user 
will have to choose from is sorted or not when shown the choice box dialog.  
Default is false.}

\perlnote{In wxPerl {\tt templates} is a reference to a list of templates.}


\membersection{wxDocManager::SelectViewType}\label{wxdocmanagerselectviewtype}

\func{wxDocTemplate *}{SelectViewType}{\param{wxDocTemplate **}{templates},
 \param{int}{ noTemplates}, \param{bool}{ sort=false}}

Returns a document template by asking the user (if there is more than one template),
displaying a list of valid views. This function is used in wxDocManager::CreateView.
The dialog normally will not appear because the array of templates only contains
those relevant to the document in question, and often there will only be one such.

\wxheading{Parameters}

\docparam{templates}{Pointer to an array of templates from which to choose a desired template.}
\docparam{noTemplates}{Number of templates being pointed to by the {\it templates} pointer.}
\docparam{sort}{If more than one template is passed in in {\it templates}, 
then this parameter indicates whether the list of templates that the user 
will have to choose from is sorted or not when shown the choice box dialog.  
Default is false.}

\perlnote{In wxPerl {\tt templates} is a reference to a list of templates.}


\membersection{wxDocManager::SetLastDirectory}\label{wxdocmanagersetlastdirectory}

\func{void}{SetLastDirectory}{\param{const wxString\&}{ dir}}

Sets the directory to be displayed to the user when opening a file. Initially this is empty.


\membersection{wxDocManager::SetMaxDocsOpen}\label{wxdocmanagersetmaxdocsopen}

\func{void}{SetMaxDocsOpen}{\param{int}{ n}}

Sets the maximum number of documents that can be open at a time. By default, this
is 10,000. If you set it to 1, existing documents will be saved and deleted
when the user tries to open or create a new one (similar to the behaviour
of Windows Write, for example). Allowing multiple documents gives behaviour
more akin to MS Word and other Multiple Document Interface applications.

